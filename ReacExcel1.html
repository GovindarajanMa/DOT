<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8" />
	<script src="jquery-1.3.2.min.js" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.7.7/xlsx.core.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xls/0.7.4-a/xls.core.min.js"></script>
	<script>
		$(document).ready(function () {
		    //alert("call");
		    var excelUrl = "https://massgov.github.io/DOT/Chapter90.xlsx";
		    var req = new XMLHttpRequest();
		    req.open("GET", excelUrl, true);
		    req.responseType = "arraybuffer";
		    req.onload = function (e) {
		        //alert("call1");
		        var data = new Uint8Array(req.response);
		        alert("data");
		        var workbook = XLSX.read(data, { type: "array" });

		        /* DO SOMETHING WITH workbook HERE */
		    }
		    req.send();
		});

		function BindTable(jsondata, tableid) {/*Function used to convert the JSON array to Html Table*/
			var columns = BindTableHeader(jsondata, tableid); /*Gets all the column headings of Excel*/
			for (var i = 0; i < jsondata.length; i++) {
				var row$ = $('<tr/>');
				for (var colIndex = 0; colIndex < columns.length; colIndex++) {
					var cellValue = jsondata[i][columns[colIndex]];
					if (cellValue == null)
						cellValue = "";
					row$.append($('<td/>').html(cellValue));
				}
				$(tableid).append(row$);
			}
		}
		function BindTableHeader(jsondata, tableid) {/*Function used to get all column names from JSON and bind the html table header*/
			var columnSet = [];
			var headerTr$ = $('<tr/>');
			for (var i = 0; i < jsondata.length; i++) {
				var rowHash = jsondata[i];
				for (var key in rowHash) {
					if (rowHash.hasOwnProperty(key)) {
						if ($.inArray(key, columnSet) == -1) {/*Adding each unique column names to a variable array*/
							columnSet.push(key);
							headerTr$.append($('<th/>').html(key));
						}
					}
				}
			}
			$(tableid).append(headerTr$);
			return columnSet;
		}
	</script>
</head>
<body>
	<table id="exceltable"></table> 
</body>
</html>
